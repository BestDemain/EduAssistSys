[{"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\index.js":"1","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\App.js":"2","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\AppHeader.js":"3","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\AppSider.js":"4","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\KnowledgeAnalysis.js":"5","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\BehaviorAnalysis.js":"6","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\Dashboard.js":"7","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\DifficultyAnalysis.js":"8","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\ReportGenerator.js":"9","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\NLPInteraction.js":"10","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\D3Visualizations\\index.js":"11","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\D3Visualizations\\KnowledgeForceGraph.js":"12","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\D3Visualizations\\SubmissionTimeline.js":"13","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\D3Visualizations\\DifficultyScatterPlot.js":"14"},{"size":359,"mtime":1745595494084,"results":"15","hashOfConfig":"16"},{"size":1948,"mtime":1746579537810,"results":"17","hashOfConfig":"16"},{"size":602,"mtime":1745595494083,"results":"18","hashOfConfig":"16"},{"size":1996,"mtime":1745595494083,"results":"19","hashOfConfig":"16"},{"size":15458,"mtime":1746773348559,"results":"20","hashOfConfig":"16"},{"size":18339,"mtime":1746771694976,"results":"21","hashOfConfig":"16"},{"size":9516,"mtime":1745595535744,"results":"22","hashOfConfig":"16"},{"size":11992,"mtime":1746771694976,"results":"23","hashOfConfig":"16"},{"size":18496,"mtime":1746593586183,"results":"24","hashOfConfig":"16"},{"size":7207,"mtime":1746593586134,"results":"25","hashOfConfig":"16"},{"size":290,"mtime":1746771694974,"results":"26","hashOfConfig":"16"},{"size":5762,"mtime":1746773409409,"results":"27","hashOfConfig":"16"},{"size":6011,"mtime":1746771694976,"results":"28","hashOfConfig":"16"},{"size":7347,"mtime":1746771694973,"results":"29","hashOfConfig":"16"},{"filePath":"30","messages":"31","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},"gm7nzx",{"filePath":"33","messages":"34","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"35","messages":"36","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"37","messages":"38","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"32"},{"filePath":"39","messages":"40","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"41","messages":"42","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"43","messages":"44","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"45","usedDeprecatedRules":"32"},{"filePath":"46","messages":"47","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"48","messages":"49","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"50","usedDeprecatedRules":"32"},{"filePath":"51","messages":"52","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"53","usedDeprecatedRules":"32"},{"filePath":"54","messages":"55","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"56","messages":"57","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"58","messages":"59","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"60","messages":"61","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\index.js",[],["62","63"],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\App.js",[],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\AppHeader.js",[],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\AppSider.js",[],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\KnowledgeAnalysis.js",[],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\BehaviorAnalysis.js",["64"],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\Dashboard.js",["65"],"import React, { useState, useEffect } from 'react';\r\nimport { Row, Col, Card, Statistic, Spin, Alert } from 'antd';\r\nimport { UserOutlined, BookOutlined, FileTextOutlined, CheckCircleOutlined } from '@ant-design/icons';\r\nimport ReactECharts from 'echarts-for-react';\r\nimport axios from 'axios';\r\n\r\nconst Dashboard = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [stats, setStats] = useState({\r\n    totalStudents: 0,\r\n    totalQuestions: 0,\r\n    totalSubmissions: 0,\r\n    correctRate: 0\r\n  });\r\n  \r\n  // 知识点掌握度数据\r\n  const [knowledgeMastery, setKnowledgeMastery] = useState([]);\r\n  \r\n  // 学习行为数据\r\n  const [behaviorData, setBehaviorData] = useState({\r\n    hourDistribution: [],\r\n    stateDistribution: []\r\n  });\r\n  \r\n  useEffect(() => {\r\n    // 加载仪表盘数据\r\n    const fetchDashboardData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        \r\n        // 获取学生数据\r\n        const studentsResponse = await axios.get('/api/students');\r\n        \r\n        // 获取题目数据\r\n        const questionsResponse = await axios.get('/api/questions');\r\n        \r\n        // 获取提交记录数据\r\n        const submissionsResponse = await axios.get('/api/submissions');\r\n        \r\n        // 计算正确率\r\n        const submissions = submissionsResponse.data;\r\n        const correctSubmissions = submissions.filter(s => s.state === 'Absolutely_Correct').length;\r\n        const correctRate = submissions.length > 0 ? correctSubmissions / submissions.length : 0;\r\n        \r\n        // 更新统计数据\r\n        setStats({\r\n          totalStudents: studentsResponse.data.length,\r\n          totalQuestions: questionsResponse.data.length,\r\n          totalSubmissions: submissions.length,\r\n          correctRate: correctRate\r\n        });\r\n        \r\n        // 获取知识点掌握度分析数据\r\n        const knowledgeResponse = await axios.get('/api/analysis/knowledge');\r\n        if (knowledgeResponse.data.status === 'success') {\r\n          const knowledgeData = knowledgeResponse.data.knowledge_mastery;\r\n          const knowledgeArray = Object.entries(knowledgeData).map(([key, value]) => ({\r\n            name: key,\r\n            value: (value.correct_rate * 100).toFixed(2)\r\n          }));\r\n          setKnowledgeMastery(knowledgeArray);\r\n        }\r\n        \r\n        // 获取学习行为分析数据\r\n        const behaviorResponse = await axios.get('/api/analysis/behavior');\r\n        if (behaviorResponse.data.status === 'success') {\r\n          const behaviorProfile = behaviorResponse.data.behavior_profile;\r\n          \r\n          // 处理小时分布数据\r\n          const hourData = behaviorProfile.peak_hours.map(item => ({\r\n            hour: item.hour,\r\n            count: item.count\r\n          }));\r\n          \r\n          // 处理状态分布数据\r\n          const stateData = Object.entries(behaviorProfile.state_distribution).filter(([key, value]) => !key.match(/[^\\x00-\\x7F]/)).map(([key, value]) => ({\r\n            name: key,\r\n            value: value\r\n          }));\r\n          \r\n          setBehaviorData({\r\n            hourDistribution: hourData,\r\n            stateDistribution: stateData\r\n          });\r\n        }\r\n        \r\n        setLoading(false);\r\n      } catch (err) {\r\n        console.error('加载仪表盘数据失败:', err);\r\n        setError('加载数据失败，请稍后重试');\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchDashboardData();\r\n  }, []);\r\n  \r\n  // 知识点掌握度图表配置\r\n  const getKnowledgeChartOption = () => {\r\n    const names = knowledgeMastery.map(item => item.name);\r\n    const values = knowledgeMastery.map(item => parseFloat(item.value));\r\n    return {\r\n      title: {\r\n        text: '知识点掌握度分布',\r\n        left: 'center'\r\n      },\r\n      tooltip: {\r\n        trigger: 'axis',\r\n        axisPointer: {\r\n          type: 'shadow'\r\n        }\r\n      },\r\n      xAxis: {\r\n        type: 'category',\r\n        data: names,\r\n        name: '知识点'\r\n      },\r\n      yAxis: {\r\n        type: 'value',\r\n        name: '掌握度 (%)'\r\n      },\r\n      series: [\r\n        {\r\n          name: '掌握度',\r\n          type: 'bar',\r\n          data: values,\r\n          itemStyle: {\r\n            color: '#1890ff'\r\n          }\r\n        }\r\n      ]\r\n    };\r\n  };\r\n  \r\n  // 学习行为图表配置 - 小时分布\r\n  const getHourChartOption = () => {\r\n    const hours = behaviorData.hourDistribution.map(item => item.hour);\r\n    const counts = behaviorData.hourDistribution.map(item => item.count);\r\n    \r\n    return {\r\n      title: {\r\n        text: '答题时间分布',\r\n        left: 'center'\r\n      },\r\n      tooltip: {\r\n        trigger: 'axis',\r\n        axisPointer: {\r\n          type: 'shadow'\r\n        }\r\n      },\r\n      xAxis: {\r\n        type: 'category',\r\n        data: hours,\r\n        name: '小时'\r\n      },\r\n      yAxis: {\r\n        type: 'value',\r\n        name: '提交次数'\r\n      },\r\n      series: [\r\n        {\r\n          name: '提交次数',\r\n          type: 'bar',\r\n          data: counts,\r\n          itemStyle: {\r\n            color: '#1890ff'\r\n          }\r\n        }\r\n      ]\r\n    };\r\n  };\r\n  \r\n  // 学习行为图表配置 - 状态分布\r\n  const getStateChartOption = () => {\r\n    return {\r\n      title: {\r\n        text: '答题状态分布',\r\n        left: 'center'\r\n      },\r\n      tooltip: {\r\n        trigger: 'item',\r\n        formatter: '{a} <br/>{b}: {c} ({d}%)'\r\n      },\r\n      series: [\r\n        {\r\n          name: '答题状态',\r\n          type: 'pie',\r\n          radius: '60%',\r\n          center: ['50%', '50%'],\r\n          data: behaviorData.stateDistribution,\r\n          emphasis: {\r\n            itemStyle: {\r\n              shadowBlur: 10,\r\n              shadowOffsetX: 0,\r\n              shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    };\r\n  };\r\n  \r\n  if (loading) {\r\n    return <Spin tip=\"加载中...\" size=\"large\" style={{ display: 'flex', justifyContent: 'center', marginTop: '100px' }} />;\r\n  }\r\n  \r\n  if (error) {\r\n    return <Alert message=\"错误\" description={error} type=\"error\" showIcon />;\r\n  }\r\n  \r\n  return (\r\n    <div>\r\n      <h2>系统总览</h2>\r\n      \r\n      {/* 统计卡片 */}\r\n      <Row gutter={16}>\r\n        <Col xs={24} sm={12} md={6}>\r\n          <Card className=\"stat-card\">\r\n            <Statistic\r\n              title=\"学生总数\"\r\n              value={stats.totalStudents}\r\n              prefix={<UserOutlined />}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col xs={24} sm={12} md={6}>\r\n          <Card className=\"stat-card\">\r\n            <Statistic\r\n              title=\"题目总数\"\r\n              value={stats.totalQuestions}\r\n              prefix={<BookOutlined />}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col xs={24} sm={12} md={6}>\r\n          <Card className=\"stat-card\">\r\n            <Statistic\r\n              title=\"提交总数\"\r\n              value={stats.totalSubmissions}\r\n              prefix={<FileTextOutlined />}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col xs={24} sm={12} md={6}>\r\n          <Card className=\"stat-card\">\r\n            <Statistic\r\n              title=\"正确率\"\r\n              value={stats.correctRate}\r\n              precision={2}\r\n              formatter={(value) => `${(value * 100).toFixed(2)}%`}\r\n              prefix={<CheckCircleOutlined />}\r\n            />\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n      \r\n      {/* 图表 */}\r\n      <Row gutter={16}>\r\n        <Col xs={24} md={12}>\r\n          <Card className=\"chart-card\" title=\"知识点掌握度分析\">\r\n            <ReactECharts\r\n              option={getKnowledgeChartOption()}\r\n              style={{ height: '350px', width: '100%' }}\r\n              className=\"chart-container\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col xs={24} md={12}>\r\n          <Card className=\"chart-card\" title=\"答题时间分布\">\r\n            <ReactECharts\r\n              option={getHourChartOption()}\r\n              style={{ height: '350px', width: '100%' }}\r\n              className=\"chart-container\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n      \r\n      <Row gutter={16}>\r\n        <Col xs={24} md={12}>\r\n          <Card className=\"chart-card\" title=\"答题状态分布\">\r\n            <ReactECharts\r\n              option={getStateChartOption()}\r\n              style={{ height: '350px', width: '100%' }}\r\n              className=\"chart-container\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col xs={24} md={12}>\r\n          <Card className=\"chart-card\" title=\"系统功能导航\">\r\n            <div style={{ padding: '20px', height: '100%' }}>\r\n              <h3>系统功能</h3>\r\n              <ul>\r\n                <li><strong>知识点分析</strong>：分析学习者知识点掌握程度，识别薄弱环节</li>\r\n                <li><strong>学习行为分析</strong>：挖掘个性化学习行为模式，展示学习者画像</li>\r\n                <li><strong>题目难度分析</strong>：识别不合理的题目难度，提供优化建议</li>\r\n                <li><strong>报告生成</strong>：生成包含自然语言和图表的分析报告</li>\r\n                <li><strong>自然语言交互</strong>：通过自然语言查询分析结果</li>\r\n              </ul>\r\n            </div>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Dashboard;","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\DifficultyAnalysis.js",[],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\ReportGenerator.js",["66"],"import React, { useState, useEffect } from 'react';\r\nimport { Row, Col, Card, Select, Button, Form, Checkbox, Radio, Spin, Alert, Typography, message, Tabs, Modal, Table, Tag, Tooltip, Space, Divider } from 'antd';\r\nimport { DownloadOutlined, FileTextOutlined, EyeOutlined, HistoryOutlined, SettingOutlined, DeleteOutlined } from '@ant-design/icons';\r\nimport axios from 'axios';\r\nimport ReactECharts from 'echarts-for-react';\r\n\r\nconst { Option } = Select;\r\nconst { Title, Paragraph, Text } = Typography;\r\nconst { TabPane } = Tabs;\r\n\r\nconst ReportGenerator = () => {\r\n  const [form] = Form.useForm();\r\n  const [loading, setLoading] = useState(false);\r\n  const [generating, setGenerating] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [students, setStudents] = useState([]);\r\n  const [reportPath, setReportPath] = useState(null);\r\n  const [reportHistory, setReportHistory] = useState([]);\r\n  const [previewVisible, setPreviewVisible] = useState(false);\r\n  const [previewData, setPreviewData] = useState(null);\r\n  const [activeTab, setActiveTab] = useState('generator');\r\n  const [templates, setTemplates] = useState([]);\r\n  \r\n  // 加载初始数据\r\n  useEffect(() => {\r\n    const fetchInitialData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        \r\n        // 获取学生数据\r\n        const studentsResponse = await axios.get('/api/students');\r\n        setStudents(studentsResponse.data);\r\n        \r\n        // 获取报告模板数据\r\n        const templatesResponse = await axios.get('/api/report/templates');\r\n        if (templatesResponse.data.status === 'success') {\r\n          setTemplates(templatesResponse.data.templates || []);\r\n        }\r\n        \r\n        // 获取报告历史记录\r\n        const historyResponse = await axios.get('/api/report/history');\r\n        if (historyResponse.data.status === 'success') {\r\n          setReportHistory(historyResponse.data.reports || []);\r\n        }\r\n        \r\n        setLoading(false);\r\n      } catch (err) {\r\n        console.error('加载初始数据失败:', err);\r\n        setError('加载初始数据失败，请稍后重试');\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    fetchInitialData();\r\n  }, []);\r\n  \r\n  // 生成报告\r\n  const generateReport = async (values) => {\r\n    try {\r\n      setGenerating(true);\r\n      setError(null);\r\n      setReportPath(null);\r\n      \r\n      const { reportType, studentId, format, content, templateId, customOptions } = values;\r\n      \r\n      const response = await axios.post('/api/report/generate', {\r\n        report_type: reportType,\r\n        student_id: studentId === 'all' ? null : studentId,\r\n        format: format,\r\n        content: content || [],\r\n        template_id: templateId,\r\n        custom_options: customOptions || {}\r\n      });\r\n      \r\n      if (response.data.status === 'success') {\r\n        setReportPath(response.data.report_path);\r\n        message.success('报告生成成功！');\r\n        \r\n        // 刷新报告历史记录\r\n        const historyResponse = await axios.get('/api/report/history');\r\n        if (historyResponse.data.status === 'success') {\r\n          setReportHistory(historyResponse.data.reports || []);\r\n        }\r\n      } else {\r\n        setError(response.data.message || '生成报告失败');\r\n        message.error('报告生成失败！');\r\n      }\r\n      \r\n      setGenerating(false);\r\n    } catch (err) {\r\n      console.error('生成报告失败:', err);\r\n      setError('生成报告失败，请稍后重试');\r\n      message.error('报告生成失败！');\r\n      setGenerating(false);\r\n    }\r\n  };\r\n  \r\n  // 下载报告\r\n  const downloadReport = (path) => {\r\n    if (!path) return;\r\n    \r\n    const filename = path.split('/').pop();\r\n    window.open(`/api/report/download/${filename}`, '_blank');\r\n  };\r\n  \r\n  // 预览报告\r\n  const previewReport = async (path) => {\r\n    if (!path) return;\r\n    const filename = path.split('/').pop();\r\n    window.open(`/api/report/preview/${filename}`, '_blank');\r\n  };\r\n  \r\n  // 删除报告\r\n  const deleteReport = async (reportId) => {\r\n    try {\r\n      const response = await axios.delete(`/api/report/${reportId}`);\r\n      \r\n      if (response.data.status === 'success') {\r\n        message.success('报告删除成功！');\r\n        \r\n        // 刷新报告历史记录\r\n        const historyResponse = await axios.get('/api/report/history');\r\n        if (historyResponse.data.status === 'success') {\r\n          setReportHistory(historyResponse.data.reports || []);\r\n        }\r\n      } else {\r\n        message.error('删除报告失败！');\r\n      }\r\n    } catch (err) {\r\n      console.error('删除报告失败:', err);\r\n      message.error('删除报告失败，请稍后重试');\r\n    }\r\n  };\r\n  \r\n  // 生成预览图表\r\n  const getPreviewChartOption = (chartData) => {\r\n    if (!chartData || !chartData.type) return {};\r\n    \r\n    switch (chartData.type) {\r\n      case 'pie':\r\n        return {\r\n          title: {\r\n            text: chartData.title || '图表预览',\r\n            left: 'center'\r\n          },\r\n          tooltip: {\r\n            trigger: 'item',\r\n            formatter: '{a} <br/>{b}: {c} ({d}%)'\r\n          },\r\n          series: [\r\n            {\r\n              name: chartData.seriesName || '数据',\r\n              type: 'pie',\r\n              radius: '60%',\r\n              center: ['50%', '50%'],\r\n              data: chartData.data || [],\r\n              emphasis: {\r\n                itemStyle: {\r\n                  shadowBlur: 10,\r\n                  shadowOffsetX: 0,\r\n                  shadowColor: 'rgba(0, 0, 0, 0.5)'\r\n                }\r\n              }\r\n            }\r\n          ]\r\n        };\r\n      case 'bar':\r\n        return {\r\n          title: {\r\n            text: chartData.title || '图表预览',\r\n            left: 'center'\r\n          },\r\n          tooltip: {\r\n            trigger: 'axis',\r\n            axisPointer: {\r\n              type: 'shadow'\r\n            }\r\n          },\r\n          xAxis: {\r\n            type: 'category',\r\n            data: chartData.xAxisData || []\r\n          },\r\n          yAxis: {\r\n            type: 'value'\r\n          },\r\n          series: [\r\n            {\r\n              name: chartData.seriesName || '数据',\r\n              type: 'bar',\r\n              data: chartData.data || [],\r\n              itemStyle: {\r\n                color: '#1890ff'\r\n              }\r\n            }\r\n          ]\r\n        };\r\n      case 'line':\r\n        return {\r\n          title: {\r\n            text: chartData.title || '图表预览',\r\n            left: 'center'\r\n          },\r\n          tooltip: {\r\n            trigger: 'axis'\r\n          },\r\n          xAxis: {\r\n            type: 'category',\r\n            data: chartData.xAxisData || []\r\n          },\r\n          yAxis: {\r\n            type: 'value'\r\n          },\r\n          series: [\r\n            {\r\n              name: chartData.seriesName || '数据',\r\n              type: 'line',\r\n              data: chartData.data || [],\r\n              itemStyle: {\r\n                color: '#1890ff'\r\n              }\r\n            }\r\n          ]\r\n        };\r\n      default:\r\n        return {};\r\n    }\r\n  };\r\n  \r\n  // 报告历史记录表格列定义\r\n  const historyColumns = [\r\n    {\r\n      title: '报告名称',\r\n      dataIndex: 'report_name',\r\n      key: 'report_name',\r\n      ellipsis: true,\r\n      render: (text, record) => (\r\n        <Tooltip title={text}>\r\n          <span>{text}</span>\r\n        </Tooltip>\r\n      )\r\n    },\r\n    {\r\n      title: '报告类型',\r\n      dataIndex: 'report_type',\r\n      key: 'report_type',\r\n      render: (text) => {\r\n        const typeMap = {\r\n          'general': '综合分析报告',\r\n          'knowledge': '知识点掌握报告',\r\n          'behavior': '学习行为报告',\r\n          'difficulty': '题目难度报告'\r\n        };\r\n        return typeMap[text] || text;\r\n      }\r\n    },\r\n    {\r\n      title: '学生',\r\n      dataIndex: 'student_id',\r\n      key: 'student_id',\r\n      render: (text) => text || '所有学生'\r\n    },\r\n    {\r\n      title: '格式',\r\n      dataIndex: 'format',\r\n      key: 'format',\r\n      render: (text) => (\r\n        <Tag color=\"blue\">{text.toUpperCase()}</Tag>\r\n      )\r\n    },\r\n    {\r\n      title: '生成时间',\r\n      dataIndex: 'created_at',\r\n      key: 'created_at',\r\n      sorter: (a, b) => new Date(a.created_at) - new Date(b.created_at)\r\n    },\r\n    {\r\n      title: '操作',\r\n      key: 'action',\r\n      render: (_, record) => (\r\n        <Space size=\"middle\">\r\n          <Button \r\n            type=\"link\" \r\n            icon={<EyeOutlined />} \r\n            onClick={() => previewReport(record.report_path)}\r\n          >\r\n            预览\r\n          </Button>\r\n          <Button \r\n            type=\"link\" \r\n            icon={<DownloadOutlined />} \r\n            onClick={() => downloadReport(record.report_path)}\r\n          >\r\n            下载\r\n          </Button>\r\n          <Button \r\n            type=\"link\" \r\n            danger \r\n            icon={<DeleteOutlined />} \r\n            onClick={() => deleteReport(record.id)}\r\n          >\r\n            删除\r\n          </Button>\r\n        </Space>\r\n      )\r\n    }\r\n  ];\r\n  \r\n  return (\r\n    <div>\r\n      <Title level={2}>报告生成</Title>\r\n      <Paragraph>\r\n        本模块可生成包含自然语言和图表元素的分析报告，支持通过交互式操作指定报告的格式、内容和范围。\r\n      </Paragraph>\r\n      \r\n      <Tabs activeKey={activeTab} onChange={setActiveTab}>\r\n        <TabPane \r\n          tab={<span><FileTextOutlined />报告生成器</span>} \r\n          key=\"generator\"\r\n        >\r\n          <Card>\r\n            <Form\r\n              form={form}\r\n              layout=\"vertical\"\r\n              onFinish={generateReport}\r\n              initialValues={{\r\n                reportType: 'general',\r\n                format: 'pdf',\r\n                content: ['knowledge', 'behavior', 'difficulty'],\r\n                templateId: templates.length > 0 ? templates[0].id : undefined\r\n              }}\r\n            >\r\n              <Row gutter={16}>\r\n                <Col xs={24} md={12}>\r\n                  <Form.Item\r\n                    name=\"reportType\"\r\n                    label=\"报告类型\"\r\n                    rules={[{ required: true, message: '请选择报告类型' }]}\r\n                  >\r\n                    <Radio.Group>\r\n                      <Radio value=\"general\">综合分析报告</Radio>\r\n                      <Radio value=\"knowledge\">知识点掌握报告</Radio>\r\n                      <Radio value=\"behavior\">学习行为报告</Radio>\r\n                      <Radio value=\"difficulty\">题目难度报告</Radio>\r\n                    </Radio.Group>\r\n                  </Form.Item>\r\n                </Col>\r\n                \r\n                <Col xs={24} md={12}>\r\n                  <Form.Item\r\n                    name=\"studentId\"\r\n                    label=\"学生\"\r\n                    rules={[{ required: true, message: '请选择学生' }]}\r\n                    initialValue=\"all\"\r\n                  >\r\n                    <Select placeholder=\"选择学生\" loading={loading}>\r\n                      <Option value=\"all\">所有学生</Option>\r\n                      {students.map(student => (\r\n                        <Option key={student.student_ID} value={student.student_ID}>\r\n                          {student.student_ID} {student.sex ? `(${student.sex})` : ''}\r\n                        </Option>\r\n                      ))}\r\n                    </Select>\r\n                  </Form.Item>\r\n                </Col>\r\n              </Row>\r\n              \r\n              <Row gutter={16}>\r\n                <Col xs={24} md={12}>\r\n                  <Form.Item\r\n                    name=\"format\"\r\n                    label=\"报告格式\"\r\n                    rules={[{ required: true, message: '请选择报告格式' }]}\r\n                  >\r\n                    <Radio.Group>\r\n                      <Radio value=\"pdf\">PDF</Radio>\r\n                      <Radio value=\"html\">HTML</Radio>\r\n                      <Radio value=\"docx\">Word</Radio>\r\n                      <Radio value=\"xlsx\">Excel</Radio>\r\n                    </Radio.Group>\r\n                  </Form.Item>\r\n                </Col>\r\n                \r\n                <Col xs={24} md={12}>\r\n                  <Form.Item\r\n                    name=\"templateId\"\r\n                    label=\"报告模板\"\r\n                    rules={[{ required: true, message: '请选择报告模板' }]}\r\n                  >\r\n                    <Select placeholder=\"选择模板\" loading={loading}>\r\n                      {templates.map(template => (\r\n                        <Option key={template.id} value={template.id}>\r\n                          {template.name}\r\n                        </Option>\r\n                      ))}\r\n                    </Select>\r\n                  </Form.Item>\r\n                </Col>\r\n              </Row>\r\n              \r\n              <Divider orientation=\"left\">报告内容</Divider>\r\n              \r\n              <Row gutter={16}>\r\n                <Col span={24}>\r\n                  <Form.Item\r\n                    name=\"content\"\r\n                    label=\"分析内容\"\r\n                  >\r\n                    <Checkbox.Group style={{ width: '100%' }}>\r\n                      <Row gutter={[16, 16]}>\r\n                        <Col span={8}>\r\n                          <Card size=\"small\" hoverable>\r\n                            <Checkbox value=\"knowledge\">知识点分析</Checkbox>\r\n                            <div style={{ marginTop: 8, marginLeft: 24 }}>\r\n                              <Text type=\"secondary\">包含知识点掌握度、薄弱点等分析</Text>\r\n                            </div>\r\n                          </Card>\r\n                        </Col>\r\n                        <Col span={8}>\r\n                          <Card size=\"small\" hoverable>\r\n                            <Checkbox value=\"behavior\">行为分析</Checkbox>\r\n                            <div style={{ marginTop: 8, marginLeft: 24 }}>\r\n                              <Text type=\"secondary\">包含学习行为、答题习惯等分析</Text>\r\n                            </div>\r\n                          </Card>\r\n                        </Col>\r\n                        <Col span={8}>\r\n                          <Card size=\"small\" hoverable>\r\n                            <Checkbox value=\"difficulty\">难度分析</Checkbox>\r\n                            <div style={{ marginTop: 8, marginLeft: 24 }}>\r\n                              <Text type=\"secondary\">包含题目难度、不合理题目等分析</Text>\r\n                            </div>\r\n                          </Card>\r\n                        </Col>\r\n                      </Row>\r\n                    </Checkbox.Group>\r\n                  </Form.Item>\r\n                </Col>\r\n              </Row>\r\n              \r\n              <Form.Item>\r\n                <Space>\r\n                  <Button type=\"primary\" htmlType=\"submit\" loading={generating}>\r\n                    生成报告\r\n                  </Button>\r\n                  <Button \r\n                    icon={<SettingOutlined />}\r\n                    onClick={() => message.info('高级设置功能即将上线')}\r\n                  >\r\n                    高级设置\r\n                  </Button>\r\n                </Space>\r\n              </Form.Item>\r\n            </Form>\r\n            \r\n            {error && <Alert message=\"错误\" description={error} type=\"error\" showIcon style={{ marginTop: 16 }} />}\r\n            \r\n            {reportPath && (\r\n              <Card style={{ marginTop: 16, textAlign: 'center' }}>\r\n                <FileTextOutlined style={{ fontSize: 48, color: '#1890ff', marginBottom: 16 }} />\r\n                <Title level={4}>报告已生成</Title>\r\n                <Space style={{ marginTop: 16 }}>\r\n                  <Button \r\n                    type=\"primary\" \r\n                    icon={<DownloadOutlined />} \r\n                    onClick={() => downloadReport(reportPath)}\r\n                  >\r\n                    下载报告\r\n                  </Button>\r\n                  <Button \r\n                    icon={<EyeOutlined />} \r\n                    onClick={() => previewReport(reportPath)}\r\n                  >\r\n                    预览报告\r\n                  </Button>\r\n                </Space>\r\n              </Card>\r\n            )}\r\n          </Card>\r\n        </TabPane>\r\n        \r\n        <TabPane \r\n          tab={<span><HistoryOutlined />报告历史</span>} \r\n          key=\"history\"\r\n        >\r\n          <Card>\r\n            <Table \r\n              columns={historyColumns} \r\n              dataSource={reportHistory} \r\n              rowKey=\"id\" \r\n              loading={loading}\r\n              pagination={{ pageSize: 10 }}\r\n            />\r\n          </Card>\r\n        </TabPane>\r\n      </Tabs>\r\n      \r\n      {/* 报告预览模态框 */}\r\n      <Modal\r\n        title=\"报告预览\"\r\n        visible={previewVisible}\r\n        onCancel={() => setPreviewVisible(false)}\r\n        width={800}\r\n        footer={[\r\n          <Button key=\"close\" onClick={() => setPreviewVisible(false)}>\r\n            关闭\r\n          </Button>,\r\n          <Button \r\n            key=\"download\" \r\n            type=\"primary\" \r\n            icon={<DownloadOutlined />} \r\n            onClick={() => {\r\n              downloadReport(previewData?.report_path);\r\n              setPreviewVisible(false);\r\n            }}\r\n          >\r\n            下载报告\r\n          </Button>\r\n        ]}\r\n      >\r\n        {previewData ? (\r\n          <div>\r\n            <Title level={3} style={{ textAlign: 'center' }}>{previewData.title}</Title>\r\n            \r\n            {previewData.sections?.map((section, index) => (\r\n              <div key={index} style={{ marginBottom: 24 }}>\r\n                <Title level={4}>{section.title}</Title>\r\n                <Paragraph>{section.content}</Paragraph>\r\n                \r\n                {section.charts?.map((chart, chartIndex) => (\r\n                  <div key={chartIndex} style={{ marginTop: 16, marginBottom: 16 }}>\r\n                    <ReactECharts \r\n                      option={getPreviewChartOption(chart)} \r\n                      style={{ height: 300 }} \r\n                    />\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <Spin tip=\"加载预览数据...\" />\r\n        )}\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReportGenerator;","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\pages\\NLPInteraction.js",["67","68"],"import React, { useState, useEffect, useRef } from 'react';\r\nimport { Input, Button, Card, List, Typography, Spin, message, Divider, Select } from 'antd';\r\nimport { SendOutlined, RobotOutlined, UserOutlined } from '@ant-design/icons';\r\nimport axios from 'axios';\r\n\r\nconst { TextArea } = Input;\r\nconst { Title, Paragraph, Text } = Typography;\r\nconst { Option } = Select;\r\n\r\nexport default function NLPInteraction() {\r\n  const [query, setQuery] = useState('');\r\n  const [messages, setMessages] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [modelType, setModelType] = useState('backend'); // 'backend' 或 'deepseek'\r\n  const messagesEndRef = useRef(null);\r\n\r\n  // 自动滚动到最新消息\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  // 添加欢迎消息\r\n  useEffect(() => {\r\n    setMessages([\r\n      {\r\n        type: 'system',\r\n        content: '欢迎使用教育辅助可视分析系统的自然语言交互功能。您可以询问关于知识点掌握情况、学习行为模式和题目难度的问题，也可以请求生成分析报告。'\r\n      }\r\n    ]);\r\n  }, []);\r\n\r\n  // 处理查询提交\r\n  const handleSubmit = async () => {\r\n    if (!query.trim()) return;\r\n\r\n    // 添加用户消息\r\n    const userMessage = { type: 'user', content: query };\r\n    setMessages(prev => [...prev, userMessage]);\r\n    \r\n    // 清空输入框\r\n    setQuery('');\r\n    \r\n    // 设置加载状态\r\n    setLoading(true);\r\n    \r\n    try {\r\n      let response;\r\n      \r\n      if (modelType === 'backend') {\r\n        // 使用后端NLP服务\r\n        response = await axios.post('/api/nlp/query', { query });\r\n        \r\n        // 添加系统回复\r\n        const systemMessage = { \r\n          type: 'system', \r\n          content: response.data.content || '抱歉，我无法理解您的问题。',\r\n          data: response.data\r\n        };\r\n        \r\n        setMessages(prev => [...prev, systemMessage]);\r\n      } else {\r\n        // 使用本地Deepseek模型\r\n        const deepseekResponse = await callDeepseekModel(query);\r\n        \r\n        // 添加系统回复\r\n        const systemMessage = { \r\n          type: 'system', \r\n          content: deepseekResponse,\r\n          model: 'deepseek'\r\n        };\r\n        \r\n        setMessages(prev => [...prev, systemMessage]);\r\n      }\r\n    } catch (error) {\r\n      console.error('查询处理失败:', error);\r\n      message.error('查询处理失败，请稍后重试');\r\n      \r\n      // 添加错误消息\r\n      const errorMessage = { \r\n        type: 'system', \r\n        content: '抱歉，处理您的请求时出现了错误。请稍后重试。',\r\n        error: true\r\n      };\r\n      \r\n      setMessages(prev => [...prev, errorMessage]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // 调用本地Deepseek模型\r\n  const callDeepseekModel = async (prompt) => {\r\n    try {\r\n      const url = \"http://localhost:11434/api/generate\";\r\n      \r\n      const data = {\r\n        model: \"deepseek-r1:8b\",\r\n        prompt: prompt,\r\n        stream: false,\r\n      };\r\n      \r\n      const response = await axios.post(url, data);\r\n      \r\n      if (response.status === 200) {\r\n        return response.data.response;\r\n      } else {\r\n        throw new Error(`请求失败，状态码: ${response.status}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Deepseek模型调用失败:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  // 渲染消息内容\r\n  const renderMessageContent = (message) => {\r\n    if (message.type === 'system' && message.data && message.data.type === 'report') {\r\n      // 渲染报告链接\r\n      return (\r\n        <div>\r\n          <Paragraph>{message.content}</Paragraph>\r\n          <Button type=\"primary\" href={`/api/report/download/${message.data.report_path.split('/').pop()}`} target=\"_blank\">\r\n            下载报告\r\n          </Button>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    // 普通文本消息\r\n    return <Paragraph>{message.content}</Paragraph>;\r\n  };\r\n\r\n  return (\r\n    <div style={{ maxWidth: '1000px', margin: '0 auto' }}>\r\n      <Card\r\n        title={\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n            <Title level={4}>自然语言交互</Title>\r\n            <Select \r\n              value={modelType} \r\n              onChange={setModelType} \r\n              style={{ width: 200 }}\r\n            >\r\n              <Option value=\"backend\">后端NLP服务</Option>\r\n              <Option value=\"deepseek\">本地Deepseek模型</Option>\r\n            </Select>\r\n          </div>\r\n        }\r\n        style={{ marginBottom: 20 }}\r\n      >\r\n        <Paragraph>\r\n          您可以使用自然语言向系统提问，获取关于学生学习情况的分析结果。\r\n          例如：\r\n        </Paragraph>\r\n        <ul>\r\n          <li>\"分析学生ID:12345的知识点掌握情况\"</li>\r\n          <li>\"查看学生的学习行为模式\"</li>\r\n          <li>\"生成一份PDF格式的知识点掌握报告\"</li>\r\n        </ul>\r\n      </Card>\r\n      \r\n      <Card\r\n        style={{ \r\n          height: '500px', \r\n          marginBottom: 20, \r\n          display: 'flex', \r\n          flexDirection: 'column' \r\n        }}\r\n        bodyStyle={{ \r\n          flex: 1, \r\n          overflow: 'auto', \r\n          padding: '12px 24px',\r\n          display: 'flex',\r\n          flexDirection: 'column'\r\n        }}\r\n      >\r\n        <List\r\n          itemLayout=\"horizontal\"\r\n          dataSource={messages}\r\n          style={{ flex: 1 }}\r\n          renderItem={(message) => (\r\n            <List.Item style={{ padding: '8px 0' }}>\r\n              <List.Item.Meta\r\n                avatar={\r\n                  message.type === 'user' ? \r\n                  <UserOutlined style={{ fontSize: '24px', color: '#1890ff' }} /> : \r\n                  <RobotOutlined style={{ fontSize: '24px', color: '#52c41a' }} />\r\n                }\r\n                title={message.type === 'user' ? '您' : '系统'}\r\n                description={renderMessageContent(message)}\r\n              />\r\n            </List.Item>\r\n          )}\r\n        />\r\n        <div ref={messagesEndRef} />\r\n        \r\n        {loading && (\r\n          <div style={{ textAlign: 'center', padding: '20px 0' }}>\r\n            <Spin tip=\"正在处理您的请求...\" />\r\n          </div>\r\n        )}\r\n      </Card>\r\n      \r\n      <div style={{ display: 'flex' }}>\r\n        <TextArea\r\n          value={query}\r\n          onChange={(e) => setQuery(e.target.value)}\r\n          placeholder=\"请输入您的问题...\"\r\n          autoSize={{ minRows: 2, maxRows: 6 }}\r\n          onPressEnter={(e) => {\r\n            if (!e.shiftKey) {\r\n              e.preventDefault();\r\n              handleSubmit();\r\n            }\r\n          }}\r\n          style={{ flex: 1, marginRight: 8 }}\r\n        />\r\n        <Button \r\n          type=\"primary\" \r\n          icon={<SendOutlined />} \r\n          onClick={handleSubmit}\r\n          loading={loading}\r\n          style={{ height: 'auto' }}\r\n        >\r\n          发送\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\D3Visualizations\\index.js",[],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\D3Visualizations\\KnowledgeForceGraph.js",[],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\D3Visualizations\\SubmissionTimeline.js",[],"D:\\Vscode\\Project\\VisualAnalytics\\EduAssistSys\\frontend\\src\\components\\D3Visualizations\\DifficultyScatterPlot.js",[],{"ruleId":"69","replacedBy":"70"},{"ruleId":"71","replacedBy":"72"},{"ruleId":"73","severity":1,"message":"74","line":2,"column":42,"nodeType":"75","messageId":"76","endLine":2,"endColumn":47},{"ruleId":"77","severity":1,"message":"78","line":77,"column":116,"nodeType":"79","messageId":"80","endLine":77,"endColumn":130},{"ruleId":"73","severity":1,"message":"81","line":20,"column":23,"nodeType":"75","messageId":"76","endLine":20,"endColumn":37},{"ruleId":"73","severity":1,"message":"82","line":2,"column":64,"nodeType":"75","messageId":"76","endLine":2,"endColumn":71},{"ruleId":"73","severity":1,"message":"83","line":7,"column":27,"nodeType":"75","messageId":"76","endLine":7,"endColumn":31},"no-native-reassign",["84"],"no-negated-in-lhs",["85"],"no-unused-vars","'Table' is defined but never used.","Identifier","unusedVar","no-control-regex","Unexpected control character(s) in regular expression: \\x00.","Literal","unexpected","'setPreviewData' is assigned a value but never used.","'Divider' is defined but never used.","'Text' is assigned a value but never used.","no-global-assign","no-unsafe-negation"]